# Insurance Command Center - Architecture Diagram

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       INSURANCE COMMAND CENTER                                â”‚
â”‚                    End-to-End Databricks Implementation                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow - Medallion Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚   DATA SOURCES (CSV Files - 425K+ Records)                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  Members   â”‚ â”‚  Claims  â”‚ â”‚   Call   â”‚ â”‚ Digital  â”‚ â”‚ Surveys â”‚     â”‚
â”‚   â”‚  (10K)     â”‚ â”‚  (50K)   â”‚ â”‚  Center  â”‚ â”‚  (150K)  â”‚ â”‚ (25K)   â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  (100K)  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚                  â”‚ Pharmacy â”‚ â”‚Enrollmentâ”‚                                 â”‚
â”‚                  â”‚  (75K)   â”‚ â”‚  (15K)   â”‚                                 â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Ingestion
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                               â”‚
â”‚   ğŸ¥‰ BRONZE LAYER (01_bronze_ingestion.py)                                  â”‚
â”‚   Unity Catalog: insurance_command_center.bronze.*_raw                       â”‚
â”‚                                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  Raw Data Preservation                                        â”‚         â”‚
â”‚   â”‚  â€¢ Schema Enforcement                                         â”‚         â”‚
â”‚   â”‚  â€¢ Ingestion Metadata (timestamp, source_file)               â”‚         â”‚
â”‚   â”‚  â€¢ Delta Lake Format                                         â”‚         â”‚
â”‚   â”‚  â€¢ Change Data Feed Enabled                                  â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                               â”‚
â”‚   Tables: members_raw, claims_raw, call_center_raw,                         â”‚
â”‚           digital_interactions_raw, surveys_raw,                             â”‚
â”‚           pharmacy_raw, enrollment_raw                                       â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Transformation
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                               â”‚
â”‚   ğŸ¥ˆ SILVER LAYER (02_silver_transformation.py)                             â”‚
â”‚   Unity Catalog: insurance_command_center.silver.*_clean                     â”‚
â”‚                                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  Data Quality & Business Logic                                â”‚         â”‚
â”‚   â”‚  â€¢ Deduplication                                              â”‚         â”‚
â”‚   â”‚  â€¢ Referential Integrity Validation                           â”‚         â”‚
â”‚   â”‚  â€¢ Standardization (dates, sentiment, categories)             â”‚         â”‚
â”‚   â”‚  â€¢ Enrichment:                                                â”‚         â”‚
â”‚   â”‚    - Tenure Bucketing                                         â”‚         â”‚
â”‚   â”‚    - Digitalâ†’Call Leakage Detection (24hr window)            â”‚         â”‚
â”‚   â”‚    - Repeat Call Flagging (7-day window)                     â”‚         â”‚
â”‚   â”‚    - Cost Calculations                                        â”‚         â”‚
â”‚   â”‚  â€¢ SCD Type 2 for Slowly Changing Dimensions                 â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                               â”‚
â”‚   Tables: members_clean, claims_clean, call_center_clean,                   â”‚
â”‚           digital_interactions_clean, surveys_clean,                         â”‚
â”‚           pharmacy_clean, enrollment_clean                                   â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Aggregation
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                               â”‚
â”‚   ğŸ¥‡ GOLD LAYER (03_gold_analytics.py)                                      â”‚
â”‚   Unity Catalog: insurance_command_center.gold.*                             â”‚
â”‚                                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  Business Analytics & KPIs                                    â”‚         â”‚
â”‚   â”‚                                                                â”‚         â”‚
â”‚   â”‚  1. digital_call_leakage                                      â”‚         â”‚
â”‚   â”‚     - Digital failures â†’ call conversions                     â”‚         â”‚
â”‚   â”‚     - Cost impact by journey type                             â”‚         â”‚
â”‚   â”‚     - Aggregated by topic, plan, segment, tenure             â”‚         â”‚
â”‚   â”‚                                                                â”‚         â”‚
â”‚   â”‚  2. repeat_calls_analysis                                     â”‚         â”‚
â”‚   â”‚     - Repeat call patterns with emotion tracking              â”‚         â”‚
â”‚   â”‚     - Resolution rates, transfer rates                        â”‚         â”‚
â”‚   â”‚     - Breakdown by segment and topic                          â”‚         â”‚
â”‚   â”‚                                                                â”‚         â”‚
â”‚   â”‚  3. top_opportunities                                         â”‚         â”‚
â”‚   â”‚     - Top 20 cost-saving opportunities                        â”‚         â”‚
â”‚   â”‚     - Avoidable call %, estimated savings                     â”‚         â”‚
â”‚   â”‚     - 7-day trend, primary lever (Digital/Ops/Comms)         â”‚         â”‚
â”‚   â”‚                                                                â”‚         â”‚
â”‚   â”‚  4. member_journey_timeline                                   â”‚         â”‚
â”‚   â”‚     - Cross-channel journey reconstruction                    â”‚         â”‚
â”‚   â”‚     - Time-ordered events per member                          â”‚         â”‚
â”‚   â”‚     - All touchpoints: digital, calls, surveys, claims, rx   â”‚         â”‚
â”‚   â”‚                                                                â”‚         â”‚
â”‚   â”‚  5. executive_kpis                                            â”‚         â”‚
â”‚   â”‚     - Daily rollup metrics                                    â”‚         â”‚
â”‚   â”‚     - Repeat %, negative emotion %, digital success rate     â”‚         â”‚
â”‚   â”‚     - Cost metrics, top 3 topics                              â”‚         â”‚
â”‚   â”‚     - 7-day moving averages                                   â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                               â”‚
â”‚   Materialized Views:                                                        â”‚
â”‚   - current_week_leakage                                                     â”‚
â”‚   - trending_up_opportunities                                                â”‚
â”‚   - high_risk_segments                                                       â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Analytics
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                               â”‚
â”‚   ğŸ“Š COMMAND CENTER DASHBOARD (04_command_center_dashboard.py)              â”‚
â”‚                                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  Executive Questions & Insights                               â”‚         â”‚
â”‚   â”‚                                                                â”‚         â”‚
â”‚   â”‚  â“ Question 1: Top 3 journeys driving avoidable call cost   â”‚         â”‚
â”‚   â”‚     â†’ Query: top_opportunities (rank <= 3)                    â”‚         â”‚
â”‚   â”‚                                                                â”‚         â”‚
â”‚   â”‚  â“ Question 2: Segments with highest negative emotion        â”‚         â”‚
â”‚   â”‚     â†’ Query: repeat_calls_analysis grouped by segment         â”‚         â”‚
â”‚   â”‚                                                                â”‚         â”‚
â”‚   â”‚  â“ Question 3: Digital journeys leaking to call center       â”‚         â”‚
â”‚   â”‚     â†’ Query: digital_call_leakage by journey type             â”‚         â”‚
â”‚   â”‚                                                                â”‚         â”‚
â”‚   â”‚  â“ Question 4: Digital abandonment â†’ immediate call          â”‚         â”‚
â”‚   â”‚     â†’ Query: member_journey_timeline with time windows        â”‚         â”‚
â”‚   â”‚                                                                â”‚         â”‚
â”‚   â”‚  â“ Question 5: New vs tenured member experience              â”‚         â”‚
â”‚   â”‚     â†’ Query: repeat_calls_analysis by tenure_bucket           â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                               â”‚
â”‚   Outputs:                                                                   â”‚
â”‚   - Real-time insights                                                       â”‚
â”‚   - Actionable recommendations                                               â”‚
â”‚   - Health status indicators (ğŸ”´ğŸŸ¡ğŸŸ¢)                                        â”‚
â”‚   - Executive summary reports                                                â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Technical Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Platform: Databricks Lakehouse                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ PySpark    â”‚  â”‚ Delta Lake   â”‚  â”‚ Unity Catalogâ”‚       â”‚
â”‚  â”‚ Python 3.x â”‚  â”‚ ACID Trans.  â”‚  â”‚ Governance   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚SQL Analyticsâ”‚  â”‚ Delta Engineâ”‚  â”‚ Optimizationsâ”‚       â”‚
â”‚  â”‚Visualizationsâ”‚  â”‚ Performance â”‚  â”‚ Z-Ordering   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Lineage

```
member_id (Primary Key)
    â”‚
    â”œâ”€â”€â”€ members.csv â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º members_raw â”€â”€â”€â–º members_clean
    â”‚                                                              â”‚
    â”œâ”€â”€â”€ claims.csv â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º claims_raw â”€â”€â”€â”€â–º claims_clean
    â”‚                                                              â”‚
    â”œâ”€â”€â”€ call_center.csv â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º call_center_raw â”€â”€â”€â”€â”€â–º call_center_clean â”
    â”‚                                                              â”‚                   â”‚
    â”œâ”€â”€â”€ digital_interactions.csv â”€â”€â”€â”€â”€â”€â”€â–º digital_interactions_raw â”€â”€â”€â–º digital_interactions_clean â”˜
    â”‚                                                              â”‚                   â”‚
    â”‚                                                              â–¼                   â–¼
    â”‚                                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                      â”‚  Digitalâ†’Call Leakage Logic     â”‚
    â”‚                                                      â”‚  (24-hour window matching)       â”‚
    â”‚                                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                                                              â”‚
    â”œâ”€â”€â”€ surveys.csv â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º surveys_raw â”€â”€â”€â–º surveys_clean    â”‚
    â”‚                                                              â”‚             â”‚
    â”œâ”€â”€â”€ pharmacy.csv â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º pharmacy_raw â”€â”€â–º pharmacy_clean   â”‚
    â”‚                                                              â”‚             â”‚
    â””â”€â”€â”€ enrollment.csv â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º enrollment_raw â”€â–º enrollment_clean â”‚
                                                                   â”‚             â”‚
                                                                   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                         â”‚
                                                                         â–¼
                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                               â”‚      GOLD ANALYTICS TABLES           â”‚
                                               â”‚  - digital_call_leakage             â”‚
                                               â”‚  - repeat_calls_analysis            â”‚
                                               â”‚  - top_opportunities                â”‚
                                               â”‚  - member_journey_timeline          â”‚
                                               â”‚  - executive_kpis                   â”‚
                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Metrics Flow

```
Digital Interaction â”€â”€â”€â”€â”
(Failed/Abandoned)      â”‚
                        â”‚ < 24 hours
                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º LEAKAGE DETECTED
Call Center Contact â”€â”€â”€â”€â”˜            â”‚
(Same Member)                        â”‚
                                     â–¼
                          Calculate Cost Impact
                                     â”‚
                                     â–¼
                          Aggregate by Topic/Segment
                                     â”‚
                                     â–¼
                          Rank Opportunities
                                     â”‚
                                     â–¼
                          Executive Dashboard
```

## Processing Pattern

```
Sequential Execution:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. BRONZE       â”‚  5-10 min
â”‚    Ingest Raw   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. SILVER       â”‚  10-15 min
â”‚    Clean & Enrichâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. GOLD         â”‚  15-20 min
â”‚    Aggregate    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. DASHBOARD    â”‚  2-3 min
â”‚    Query & Viz  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total Pipeline: ~30-45 minutes (initial run)
Daily Incremental: ~10-15 minutes
```

## Optimization Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Performance Optimizations             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Z-Ordering on key columns          â”‚
â”‚     - member_id, date columns          â”‚
â”‚  2. Data Skipping via Delta            â”‚
â”‚  3. Partitioning by date and plan_type â”‚
â”‚  4. Broadcast joins for small tables   â”‚
â”‚  5. Caching of frequently used tables  â”‚
â”‚  6. Optimize writes enabled            â”‚
â”‚  7. Change Data Feed for incrementals  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Security & Governance

```
Unity Catalog Hierarchy:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Catalog: insurance_command_center â”‚
â”‚                                    â”‚
â”‚ â”œâ”€â”€ Schema: bronze                â”‚
â”‚ â”‚   â”œâ”€â”€ members_raw               â”‚
â”‚ â”‚   â”œâ”€â”€ claims_raw                â”‚
â”‚ â”‚   â””â”€â”€ ... (7 tables)            â”‚
â”‚                                    â”‚
â”‚ â”œâ”€â”€ Schema: silver                â”‚
â”‚ â”‚   â”œâ”€â”€ members_clean             â”‚
â”‚ â”‚   â”œâ”€â”€ claims_clean              â”‚
â”‚ â”‚   â””â”€â”€ ... (7 tables)            â”‚
â”‚                                    â”‚
â”‚ â””â”€â”€ Schema: gold                  â”‚
â”‚     â”œâ”€â”€ digital_call_leakage      â”‚
â”‚     â”œâ”€â”€ repeat_calls_analysis     â”‚
â”‚     â””â”€â”€ ... (5 tables + 3 views)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Access Control:
- Data Engineers: MODIFY on bronze/silver
- Analysts: SELECT on silver/gold
- Executives: SELECT on gold only
- Auditing via Unity Catalog
```

## Monitoring & Alerting

```
Health Checks:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Metric          â”‚ Threshold     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Repeat Call %   â”‚ > 25% = ğŸ”´   â”‚
â”‚ Negative Emot.  â”‚ > 35% = ğŸ”´   â”‚
â”‚ Digital Success â”‚ < 70% = ğŸ”´   â”‚
â”‚ Handle Time     â”‚ > 15m = ğŸŸ¡   â”‚
â”‚ Daily Cost      â”‚ Trend > 10% ğŸ”´â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Alerts triggered via:
- Email notifications
- Slack webhooks
- Dashboard indicators
```

## Future Enhancements

```
Phase 2: Agentic AI
â”œâ”€â”€ Insight Scout Agent
â”‚   â””â”€â”€ Auto-detect anomalies daily
â”‚
â””â”€â”€ Next-Best-Action Agent
    â””â”€â”€ Recommend fixes automatically

Phase 3: Real-Time
â”œâ”€â”€ Structured Streaming
â”‚   â””â”€â”€ Live data ingestion
â”‚
â””â”€â”€ Real-Time Dashboards
    â””â”€â”€ Sub-second latency

Phase 4: Advanced Analytics
â”œâ”€â”€ Predictive Models
â”‚   â””â”€â”€ Churn prediction
â”‚
â””â”€â”€ Propensity Scoring
    â””â”€â”€ Intervention targeting

Phase 5: Operational Integration
â”œâ”€â”€ CRM Integration
â”‚   â””â”€â”€ Salesforce, ServiceNow
â”‚
â””â”€â”€ Action Tracking
    â””â”€â”€ Close the loop
```

---

**End of Architecture Diagram**
